import java.io.*;

public class main {
	
	
	public static void main (String[] args) throws IOException 
	{
		edgesWithType("list.txt");
	}
	 
	public static int countLines(String file) throws IOException {
		int i=0;
		try(BufferedReader br = new BufferedReader(new FileReader(file))) {
		    for(String line; (line = br.readLine()) != null; ) {
		    	i++;
		    }
		}
		return i;
	}

	public static void edgesWithType (String file) throws FileNotFoundException, IOException{
		try(BufferedReader br = new BufferedReader(new FileReader(file))) {
			int fileSize = countLines(file);
			String[] nodes = new String[fileSize]; 
			int i=0;
			File listFile = new File("test2.txt");
			PrintWriter listWriter = new PrintWriter(new FileWriter(listFile));
		    for(String line; (line = br.readLine()) != null; ) {
		    	String[] edges = line.split(";");
		    	nodes[i]=edges[0];
		    	i++;
		    }
		    BufferedReader b = new BufferedReader(new FileReader(file));
		    boolean[] nodeExternal = new boolean[fileSize];
		    int lineno=0;
		    for(String line; (line = b.readLine()) != null; )
		    {
		    	nodeExternal[lineno]=false;
		    	String[] edges = line.split(";");
		    	StringBuffer ExEdge = new StringBuffer();
		    	for(int j=1; j<edges.length; j++)
		    	{
		    		boolean checkEx=true;
		    		for(int k=lineno/4000*4000; k<Math.min((lineno/4000+1)*4000, fileSize); k++)
		    		{
		    			if(edges[j].replaceAll("\\s+","").equalsIgnoreCase(nodes[k].replaceAll("\\s+","")))
		    			{
		    				checkEx = false;
		    				break;
		    			}
		    		}
		    		if(checkEx==true) 
		    		{
		    			nodeExternal[lineno]=true;
		    			ExEdge.append(";").append(edges[j]);
		    		}
		    	}
		    	if (nodeExternal[lineno]==true)
		    		line = line.concat("external") + ExEdge;
		    	else
		    		line = line.concat("internal");
		    	listWriter.print(line+"\n");
		    	lineno++;
		    }
		    // line is not visible here
		}
	}
}

